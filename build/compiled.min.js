(function b(c,d,e){function a(h,i){if(!d[h]){if(!c[h]){var j="function"==typeof require&&require;if(!i&&j)return j(h,!0);if(g)return g(h,!0);var k=new Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",k}var f=d[h]={exports:{}};c[h][0].call(f.exports,function(b){var d=c[h][1][b];return a(d?d:b)},f,f.exports,b,c,d,e)}return d[h].exports}for(var g="function"==typeof require&&require,f=0;f<e.length;f++)a(e[f]);return a})({1:[function(a){"use strict";function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var c=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),d=a("./lib/glob"),e=a("./lib/log"),f=a("./lib/debugger"),g=a("./lib/mouse"),h=a("./lib/graphics"),i=function(){function a(c){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(b(this,a),this.canvas="string"==typeof c?document.getElementById(c):c,!this.canvas)throw new Error("Undefined canvas ID");this.context=this.c=this.canvas.getContext("2d"),this.options=Object.assign(a.defaults(),e),this.graphics=new h(this.context,this.options),this.mouse=new g(this.canvas),this.gamedebugger=new f(this.canvas),"dev"==this.options.env?("dev"==d.__SIDESCROLLGAME.env,this.gamedebugger.cast()):d.__SIDESCROLLGAME.env==this.options.env||"prod",this.timing={delta:0,ctime:0,frame:0,framerate:1e3/this.options.fps},this.arrangeBody(),this.bindResize(),this.resize()}return c(a,null,[{key:"defaults",value:function(){return{bgcolor:"#eaeff2",fps:60,env:"prod"}}}]),c(a,[{key:"arrangeBody",value:function(){document.body.style.margin=0,document.body.style.padding=0}},{key:"resize",value:function(){this.canvas.width=d.innerWidth,this.canvas.height=d.innerHeight,this.graphics.resize(d.innerWidth,d.innerHeight),e("Game","Handled resized at "+d.innerWidth+" x "+d.innerHeight)}},{key:"bindResize",value:function(){var a=this;d.addEventListener("resize",function(){return a.resize()})}},{key:"start",value:function(){var a=this;return e("Game","Starting engine"),this.frameRequest=requestAnimationFrame(function(b){a.draw(b)}),this}},{key:"update",value:function(){return this.graphics.clear(),this.gamedebugger.ping(),this}},{key:"draw",value:function(a){var b=this,c=this.timing.ctime-a;return c<this.timing.framerate&&(this.timing.ctime=a,this.timing.frame++,this.update()),this.frameRequest=requestAnimationFrame(function(a){b.draw(a)}),this}}]),a}();d.Game=i},{"./lib/debugger":2,"./lib/glob":4,"./lib/graphics":5,"./lib/log":6,"./lib/mouse":7}],2:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./log"),g=a("./dom"),d=a("./glob"),h=function(){function a(b){c(this,a),this.pingcount=0,this.init=!1,this.canvas=b}return e(a,[{key:"createElem",value:function(){this.elem=g.create({node:"div",id:"gamedebugger",parent:document.body,children:[{node:"div",id:"debugframecount"},{node:"div",id:"debugfps"}]}),this.outputelem=g.create({node:"div",id:"debugoutput",parent:this.elem}),this.init=!0}},{key:"bindError",value:function(){var a=this,b=arguments;d.onerror=function(){return a.error.apply(a,b)}}},{key:"addStylesheet",value:function(){g.create({node:"link",attr:{rel:"stylesheet",href:"/debug.css"},parent:document.head})}},{key:"report",value:function(){}},{key:"ping",value:function(){this.pingcount++,this.init&&(g.byID("debugframecount").textContent=this.pingcount+" frames")}},{key:"startFPS",value:function(){var a=this;this.lastpingat=0;setTimeout(function b(){g.byID("debugfps").textContent=a.pingcount-a.lastpingat+" FPS",a.lastpingat=a.pingcount,setTimeout(b,1e3)},1e3)}},{key:"log",value:function(a,b){g.create({node:"div",text:"["+new Date().toLocaleTimeString()+" - "+a+"] - "+b,parent:this.outputelem}),this.elem.scrollTop=this.outputelem.scrollHeight}},{key:"bindCanvasEvents",value:function(){}},{key:"cast",value:function(){var a=this;this.createElem(),this.addStylesheet(),this.bindError(),this.bindCanvasEvents(),this.startFPS(),f.listen(function(b,c){return a.log(b,c)}),f("Debugger","Created debugger"),this.elem.classList.add("shown")}},{key:"error",value:function(a,b,c,d,e){g.create({node:"div",text:a,attr:{style:"color : red;"},parent:this.outputelem}),g.create({node:"pre",html:e.stack,attr:{style:"color : red;"},parent:this.outputelem})}}]),a}();b.exports=h},{"./dom":3,"./glob":4,"./log":6}],3:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(){function a(){c(this,a)}return d(a,[{key:"create",value:function(a){if("text"==a.node)return document.createTextNode(a.text);var b=document.createElement(a.node);if(a.id&&(b.id=a.id),b.className=a.className||a.classList&&a.classList.join(" ")||"",a.attr)for(var c=Object.keys(a.attr),d=0;d<c.length;d++)b.setAttribute(c[d],a.attr[c[d]]);if(a.text?b.textContent=a.text:a.html&&(b.innerHTML=a.html),a.children)for(var d=0;d<a.children.length;d++)b.appendChild(this.create(a.children[d]));return a.parent&&a.parent.appendChild(b),b}},{key:"byID",value:function(a){return document.getElementById(a)}},{key:"query",value:function(a,b){return document[b?"querySelectorAll":"querySelector"](a)}}]),a}();b.exports=new e},{}],4:[function(a,b){(function(a){"use strict";var c=window;c.__SIDESCROLLGAME={env:"dev"},b.exports=c}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],5:[function(a,b){"use strict";function c(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./log"),g=function(){function a(b,c){d(this,a),this.context=this.c=b,this.options=c}return e(a,[{key:"resize",value:function(a,b){this.w=a,this.h=b,this.rect=[0,0,this.w,this.h]}},{key:"clear",value:function(){var a;this.c.fillStyle=this.options.bgcolor,(a=this.c).fillRect.apply(a,c(this.rect))}}]),a}();b.exports=g},{"./log":6}],6:[function(a,b){"use strict";var c,d=a("./glob.js"),e=function(a,b){console.log("["+new Date+" - "+a+"] "+b),c&&c(a,b)};e.listen=function(a){c=a},b.exports="dev"==d.__SIDESCROLLGAME.env?e:function(){}},{"./glob.js":4}],7:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=a("./log"),f=a("./physics"),g=function(){function a(b){c(this,a),this.canvas=b,this.bindBasicEvents(),this.vector,this.bound={mousedown:[],mouseup:[]}}return d(a,[{key:"bindBasicEvents",value:function(){var a=this;this.canvas.addEventListener("mousedown",function(b){var c=1==b.which?"left":3==b.which?"right":"other";a.vector=new f.Vector2D(b.x,b.y),e("Mouse","Mouse down at "+b.x+" x "+b.y+", using "+c+" button"),a.bound.mousedown.forEach(function(a){return a()})}),this.canvas.addEventListener("mouseup",function(b){a.vector.to(b.x,b.y),e("Mouse","Mouse released at "+b.x+" x "+b.y+", distance of "+a.vector.length()+" px"),a.bound.mouseup.forEach(function(a){return a()})})}},{key:"bind",value:function(a,b,c){this.bound[a].push(b.bind(c))}},{key:"directBind",value:function(a,b,c){this.canvas.addEventListener(a,b.bind(c))}}]),a}();b.exports=g},{"./log":6,"./physics":8}],8:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(){function a(b,d,e,f){c(this,a),this.x=b,this.y=d,this.destx=e,this.desty=f}return d(a,[{key:"to",value:function(a,b){this.destx=a,this.desty=b}},{key:"length",value:function(){var a=Math.pow;return Math.sqrt(a(this.x-this.destx,2)+a(this.y-this.desty,2))}}]),a}();b.exports={Vector2D:e}},{}]},{},[1]);
