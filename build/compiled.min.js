(function b(c,d,e){function a(h,i){if(!d[h]){if(!c[h]){var j="function"==typeof require&&require;if(!i&&j)return j(h,!0);if(g)return g(h,!0);var k=new Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",k}var f=d[h]={exports:{}};c[h][0].call(f.exports,function(b){var d=c[h][1][b];return a(d?d:b)},f,f.exports,b,c,d,e)}return d[h].exports}for(var g="function"==typeof require&&require,f=0;f<e.length;f++)a(e[f]);return a})({1:[function(a){"use strict";function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var c=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),d=a("./lib/glob"),e=a("./lib/log"),f=a("./lib/debugger"),g=a("./lib/mouse"),h=a("./lib/graphics"),i=a("./lib/spriteset"),j=a("./lib/sprite"),k=a("./lib/gelement"),l=a("./lib/physics"),m=a("./lib/keyboard"),n=function(){function a(c){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(b(this,a),this.canvas="string"==typeof c?document.getElementById(c):c,!this.canvas)throw new Error("Undefined canvas ID");this.context=this.c=this.canvas.getContext("2d"),this.options=Object.assign(a.defaults(),e),this.gamedebugger=new f(this.canvas),this.graphics=new h(this.context,this.options),this.mouse=new g(this.canvas),this.keyboard=new m(this.canvas),"dev"==this.options.env?("dev"==d.__SIDESCROLLGAME.env,this.gamedebugger.cast()):d.__SIDESCROLLGAME.env==this.options.env||"prod",this.timing={delta:0,ctime:0,frame:0,framerate:1e3/this.options.fps},this.arrangeBody(),this.bindResize(),this.resize()}return c(a,null,[{key:"defaults",value:function(){return{bgcolor:"#eaeff2",fps:60,layers:5,env:"prod"}}}]),c(a,[{key:"arrangeBody",value:function(){document.body.style.margin=0,document.body.style.padding=0}},{key:"resize",value:function(){var a=d.innerWidth,b=d.innerHeight-(this.gamedebugger.init?200:0);this.canvas.width=a,this.canvas.height=b,this.width=a,this.height=b,this.graphics.resize(a,b),e("Game","Handled resized at "+a+" x "+b)}},{key:"bindResize",value:function(){var a=this;d.addEventListener("resize",function(){return a.resize()})}},{key:"start",value:function(){var a=this;return e("Game","Starting engine"),this.frameRequest=requestAnimationFrame(function(b){a.draw(b)}),this}},{key:"update",value:function(){return this.graphics.clear(),this.graphics.draw(),this.gamedebugger.ping(),this}},{key:"draw",value:function(a){var b=this,c=this.timing.ctime-a;return c<this.timing.framerate&&(this.timing.ctime=a,this.timing.frame++,this.update()),this.frameRequest=requestAnimationFrame(function(a){b.draw(a)}),this}}]),a}();d.SideQuest={Game:n,SpriteSet:i,Sprite:j,GraphicElement:k,Physics:l,Keyboard:m,Mouse:g,log:e}},{"./lib/debugger":3,"./lib/gelement":5,"./lib/glob":6,"./lib/graphics":7,"./lib/keyboard":8,"./lib/log":9,"./lib/mouse":10,"./lib/physics":11,"./lib/sprite":12,"./lib/spriteset":13}],2:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=a("./log"),f=a("./physics"),g=function(){function a(b,d){c(this,a),this.rect=new f.Rect(0,0,b,d),this.following,this.locked=!1}return d(a,[{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.locked=!1}},{key:"follow",value:function(a){this.following=a}},{key:"resize",value:function(a,b){this.rect.w=a,this.rect.h=b}},{key:"updateFromBound",value:function(){var a=this.rect.w/2,b=this.following.vector.x-this.rect.x;b>a+this.following.rect.x?this.rect.x+=b-this.following.rect.x-a:b+this.following.rect.x<a&&(this.rect.x-=a-(b+this.following.rect.x)),0>this.rect.x&&(this.rect.x=0)}},{key:"update",value:function(){this.following&&this.updateFromBound()}}]),a}();b.exports=g},{"./log":9,"./physics":11}],3:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./log"),g=a("./dom"),d=a("./glob"),h=function(){function a(b){c(this,a),this.pingcount=0,this.init=!1,this.canvas=b}return e(a,[{key:"createElem",value:function(){this.elem=g.create({node:"div",id:"gamedebugger",parent:document.body,children:[{node:"div",id:"debugframecount"},{node:"div",id:"debugfps"}]}),this.outputelem=g.create({node:"div",id:"debugoutput",parent:this.elem}),this.init=!0}},{key:"bindError",value:function(){var f=this;d.onerror=function(g,a,b,c,d){return f.error(g,a,b,c,d)}}},{key:"addStylesheet",value:function(){g.create({node:"link",attr:{rel:"stylesheet",href:"/debug.css"},parent:document.head})}},{key:"report",value:function(){}},{key:"ping",value:function(){this.pingcount++,this.init&&(g.byID("debugframecount").textContent=this.pingcount+" frames")}},{key:"startFPS",value:function(){var a=this;this.lastpingat=0;setTimeout(function b(){g.byID("debugfps").textContent=a.pingcount-a.lastpingat+" FPS",a.lastpingat=a.pingcount,setTimeout(b,1e3)},1e3)}},{key:"log",value:function(a,b){g.create({node:"div",text:"["+new Date().toLocaleTimeString()+" - "+a+"] - "+b,parent:this.outputelem}),this.elem.scrollTop=this.outputelem.scrollHeight}},{key:"bindCanvasEvents",value:function(){}},{key:"cast",value:function(){var a=this;this.createElem(),this.addStylesheet(),this.bindError(),this.bindCanvasEvents(),this.startFPS(),f.listen(function(b,c){return a.log(b,c)}),f("Debugger","Created debugger"),this.elem.classList.add("shown")}},{key:"error",value:function(a,b,c,d,e){g.create({node:"div",text:a,attr:{style:"color : red;"},parent:this.outputelem}),g.create({node:"pre",html:e&&e.stack,attr:{style:"color : red;"},parent:this.outputelem})}}]),a}();b.exports=h},{"./dom":4,"./glob":6,"./log":9}],4:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(){function a(){c(this,a)}return d(a,[{key:"create",value:function(a){if("text"==a.node)return document.createTextNode(a.text);var b=document.createElement(a.node);if(a.id&&(b.id=a.id),b.className=a.className||a.classList&&a.classList.join(" ")||"",a.attr)for(var c=Object.keys(a.attr),d=0;d<c.length;d++)b.setAttribute(c[d],a.attr[c[d]]);if(a.text?b.textContent=a.text:a.html&&(b.innerHTML=a.html),a.children)for(var d=0;d<a.children.length;d++)b.appendChild(this.create(a.children[d]));return a.parent&&a.parent.appendChild(b),b}},{key:"byID",value:function(a){return document.getElementById(a)}},{key:"query",value:function(a,b){return document[b?"querySelectorAll":"querySelector"](a)}}]),a}();b.exports=new e},{}],5:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=Math.abs,f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./log"),h=a("./dom"),d=a("./physics"),i=a("./keyboard"),j=a("./sprite"),k=a("./spriteset"),l=function(){return{x:0,y:0,w:0,h:0,initspeed:1,maxspeed:3,gravity:0,strength:500,jumpheight:0,controlled:!1,useimagesize:!1,friction:0.2,override:{}}},m=function(){return{opacity:1}},n=function(){function a(b,e){var f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};switch(c(this,a),this.game=b,this.type=e,this.options=Object.assign(l(),f),this.vector=new d.Vector2D(this.options.x,this.options.y),this.rect=new d.Vector2D(this.options.w,this.options.h),this.collision=this.options.collision||new d.Rect(0,0,this.rect.x,this.rect.y),this.strength=this.options.strength,this.effects=Object.assign(m(),{}),this.sticked=!1,this.vector.setMaxVelocity(this.options.maxspeed,this.options.maxgravity),this.controlled=this.options.controlled,this.options.gravity&&this.applyGravity(this.options.gravity),this.type){case"image":this.initImage();break;case"sprite":this.initSprite();break;case"shape":this.initShape(f);break;default:throw new Error("GElement was created without an invalid type : "+this.type);}g("GElement","Created a new Graphic Element of type "+this.type)}return f(a,[{key:"setPosition",value:function(a,b){this.vector.at(a,b)}},{key:"initSprite",value:function(){this.sprite=this.options.sprite}},{key:"initImage",value:function(){this.url=this.options.url,this.sprite=new j({spritesets:{neutral:new k("file",this.url)},useimagesize:this.options.useimagesize}),g("GElement","Initialized Graphic Element with image at "+this.url)}},{key:"applyGravity",value:function(a){this.vector.setAcceleration(this.vector.accelx,a)}},{key:"initShape",value:function(){}},{key:"isOnFloor",value:function(){return this.sticked}},{key:"update",value:function(){return this.vector.update(),this.options.gravity&&this.vector.y+this.rect.y>this.game.height&&(this.vector.y=this.game.height-this.rect.y,this.vector.vely=0,this.sticked=!0),this}},{key:"updateState",value:function(){0>this.vector.vely?(this.sprite.changeState("jumping"),this.sticked=!1):0<this.vector.vely?(this.sticked=!1,this.sprite.changeState("falling")):0==this.vector.velx?this.sprite.changeState("neutral"):this.sprite.changeState("running")}},{key:"shouldBeDrawn",value:function(a){return 0<this.vector.x-a.rect.x+this.rect.x&&this.vector.x-a.rect.x<a.rect.w&&0<this.vector.y-a.rect.y+this.rect.y&&this.vector.y-a.rect.y<a.rect.h}},{key:"collide",value:function(a,b){if(this.strength<=b.strength){for(var c=this.collisionPoints,d=b.collisionPoints,f=[c[0][0]-d[2][0],c[0][1]-d[2][1],c[1][0]-d[3][0],c[1][1]-d[3][1],c[2][0]-d[0][0],c[2][1]-d[0][1],c[3][0]-d[1][0],c[3][1]-d[1][1]],g=0,h=f[g],j=1;j<f.length;j++)e(f[j])<h&&(g=j,h=e(f[j]));"dev"==this.game.options.env&&(a.fillStyle="green",a.fillText("Collision clipping",this.vector.x,this.vector.y-10)),0==g%2?(this.vector.velx=0,this.vector.accelx=0,this.vector.x-=f[g]):(0<this.vector.vely&&(this.sticked=!0),this.vector.vely=0,this.vector.y-=f[g])}}},{key:"collisionBox",value:function(a){return new d.Rect(this.vector.x-a.rect.x+this.collision.x,this.vector.y-a.rect.y+this.collision.y,this.collision.w,this.collision.h)}},{key:"debug",value:function(a,b,c){var d={x:this.vector.x-b.rect.x,y:this.vector.y-b.rect.y,w:this.rect.x,h:this.rect.y};c&&(a.beginPath(),a.rect(this.collision.x+d.x,this.collision.y+d.y,this.collision.w||d.w,this.collision.h||d.h),a.lineWidth=1,a.strokeStyle="red",a.stroke(),a.beginPath(),a.rect(d.x,d.y,d.w,d.h),a.lineWidth=1,a.strokeStyle="blue",a.stroke()),a.font="12px Arial, sans-serif",a.fillStyle="black",a.fillText("Relative "+this.vector.x+" x "+this.vector.y,d.x+d.w+5,d.y+10),a.fillText("Real "+(this.vector.x-b.rect.x)+" x "+(this.vector.y-b.rect.y),d.x+d.w+5,d.y+24),a.fillText("State : "+this.sprite.state,d.x+d.w+5,d.y+38),a.fillText("Velocity "+this.vector.velx+" x "+this.vector.vely,d.x+d.w+5,d.y+52),a.fillText("Acceleration "+this.vector.accelx+" x "+this.vector.accely,d.x+d.w+5,d.y+66),a.fillText("Drawn : "+(c?"Yes":"No")+", strength : "+this.strength,d.x+d.w+5,d.y+80)}},{key:"draw",value:function(a,b){var c=!1;if(this.shouldBeDrawn(b)){var d=this.sprite.draw(a,this.vector.x-b.rect.x,this.vector.y-b.rect.y,this.rect.x,this.rect.y);c=!!d,this.options.useimagesize&&d&&(this.rect.x=d.w,this.rect.y=d.h)}return"dev"==this.game.options.env&&this.debug(a,b,c),c}},{key:"override",value:function(a,b){this.override[a]=b}},{key:"jump",value:function(){this.isOnFloor()&&(this.sticked=!1,this.override.jump?this.override.jump():this.vector.vely=-this.options.jumpheight)}},{key:"keyCommand",value:function(a,b){if(b)switch(a){case i.KEY_RIGHT:this.direction="right",this.keydown=!0,this.vector.setAcceleration(this.options.friction,this.vector.accely),this.sprite.changeState(this.sprite.state,"right");break;case i.KEY_LEFT:this.direction="left",this.keydown=!0,this.vector.setAcceleration(-this.options.friction,this.vector.accely),this.sprite.changeState(this.sprite.state,"left");break;case i.KEY_SPACE:case i.KEY_UP:this.jump();break;default:}else if(this.keydown&&(a==i.KEY_LEFT||a==i.KEY_RIGHT)){this.keydown=!1;var c="left"==this.direction?1:-1;-1==c&&0<this.vector.velx||1==c&&0>this.vector.velx?this.vector.setAcceleration(this.options.friction*c,this.vector.accely,!0):this.vector.setAcceleration(this.options.friction*-c,this.vector.accely,!0),this.sprite.changeState()}}},{key:"control",value:function(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.controlled=!0,this.keyboard=a,g("GElement","Binding Graphic Element with keyboard controls"),c.arrows&&(this.keventleft=function(a,c,d){return b.keyCommand(a,c,d)},this.keventright=function(a,c,d){return b.keyCommand(a,c,d)},this.keventup=function(a,c,d){return b.keyCommand(a,c,d)},this.keventspace=function(a,c,d){return b.keyCommand(a,c,d)},a.bindKey("left",this.keventleft),a.bindKey("right",this.keventright),a.bindKey("up",this.keventup),a.bindKey("space",this.keventspace))}},{key:"giveupControll",value:function(){keyboard.killKey("left",this.keventleft),keyboard.killKey("right",this.keventright),keyboard.killKey("up",this.keventup),keyboard.killKey("space",this.keventspace)}},{key:"destroy",value:function(){g("GElement","Destroyed Graphic Element of type "+this.type),this.imagebitmap&&this.imagebitmap.close(),this.image&&this.image.remove(),this.controlled&&this.giveupControll()}},{key:"ready",get:function(){return this.sprite.currentState.ready}},{key:"collisionPoints",get:function(){return[[this.vector.x+this.collision.x+this.collision.w,this.vector.y+this.collision.y],[this.vector.x+this.collision.x,this.vector.y+this.collision.y],[this.vector.x+this.collision.x,this.vector.y+this.collision.y+this.collision.h],[this.vector.x+this.collision.x+this.collision.w,this.vector.y+this.collision.y+this.collision.h]]}}]),a}();b.exports=n},{"./dom":4,"./keyboard":8,"./log":9,"./physics":11,"./sprite":12,"./spriteset":13}],6:[function(a,b){(function(a){"use strict";var c=window;c.__SIDESCROLLGAME={env:"dev"},b.exports=c}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],7:[function(a,b){"use strict";function c(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./log"),g=a("./camera"),h=a("./physics"),j=function(){function a(b){d(this,a),this.index=b,this.graphicselements=[],this._assocGE={}}return e(a,[{key:"addElement",value:function(a,b){return f("GraphicLayer","Added an element to layer "+this.index+" with id "+a),this.graphicselements.push(b),this._assocGE[a]=b,this}},{key:"clear",value:function(){return this.graphicselements.forEach(function(a){return a.destroy()}),this.graphicselements=[],this._assocGE={},this}},{key:"impactCheck",value:function(a,b){for(var c=0;c<this.graphicselements.length;c++)for(var d=c+1;d<this.graphicselements.length;d++)h.Collider.rectangles(this.graphicselements[c].collisionBox(b),this.graphicselements[d].collisionBox(b))&&(this.graphicselements[c].collide(a,this.graphicselements[d]),this.graphicselements[d].collide(a,this.graphicselements[c]));return this}},{key:"updateStates",value:function(){return this.graphicselements.forEach(function(a){return a.updateState()}),this}},{key:"update",value:function(){return this.graphicselements.forEach(function(a){return a.update()}),this}},{key:"draw",value:function(a,b){return this.graphicselements.forEach(function(c){return c.draw(a,b)}),this}}]),a}(),i=function(){function a(b,c){d(this,a),this.context=this.c=b,this.options=c,this.camera=new g(b.width,b.height),this.layers=[],this.fixedLayer=new j(-1);for(var e=0;e<c.layers;e++)this.layers.push(new j(e))}return e(a,[{key:"resize",value:function(a,b){this.w=a,this.h=b,this.rect=[0,0,this.w,this.h],this.camera.resize(this.w,this.h)}},{key:"clear",value:function(){var a;this.c.fillStyle=this.options.bgcolor,(a=this.c).fillRect.apply(a,c(this.rect))}},{key:"addElement",value:function(a,b,c){c.id=b,this.layers[a].addElement(b,c)}},{key:"draw",value:function(){var a=this;this.camera.update(),this.layers.forEach(function(b){return b.update().impactCheck(a.context,a.camera).updateStates().draw(a.context,a.camera)})}}]),a}();b.exports=i},{"./camera":2,"./log":9,"./physics":11}],8:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=a("./log"),f=a("./glob"),g={up:38,down:40,left:37,right:39,space:32,shift:16,enter:13},h={};for(var i in g)h[i]=!1;var j=function(){function a(b){var d=this;c(this,a),this.canvas=b,e("Keyboard","Binding global key events"),this.keyEvents={13:[],16:[],32:[],37:[],38:[],39:[],40:[]},this.upEvents=[],f.addEventListener("keydown",function(a){d.down(a)}),f.addEventListener("keyup",function(a){d.up(a)})}return d(a,null,[{key:"KEY_UP",get:function(){return g.up}},{key:"KEY_DOWN",get:function(){return g.down}},{key:"KEY_LEFT",get:function(){return g.left}},{key:"KEY_RIGHT",get:function(){return g.right}},{key:"KEY_SPACE",get:function(){return g.space}},{key:"KEY_SHIFT",get:function(){return g.shift}},{key:"KEY_ENTER",get:function(){return g.enter}}]),d(a,[{key:"addKey",value:function(a,b){this.keyEvents[a]=b,g[b]=a,h[a]=!1,e("Keyboard","Registered new key "+b+" with byte "+a)}},{key:"down",value:function(a){this.keyEvents[a.which]&&!h[a.which]&&(h[a.which]=!0,this.keyEvents[a.which].forEach(function(b){return b(a.which,!0)}))}},{key:"keyToCode",value:function(a){return g[a]}},{key:"up",value:function(a){var b=this;if(this.keyEvents[a.which]&&h[a.which]){h[a.which]=!1,this.keyEvents[a.which].forEach(function(b){return b(a.which,!1)});var c=function(a){var c=g[a];h[c]&&b.keyEvents[c]&&b.keyEvents[c].forEach(function(a){return a(c,!0,!0)})};for(var d in g)c(d)}}},{key:"bindKey",value:function(a,b,c){e("Keyboard","Bound key with id "+a),this.keyEvents[g[a]||a].push(c?b.bind(c):b)}},{key:"killKey",value:function(a,b){var c=this.keyEvents[g[a]||a],d=c.indexOf(function(a){return a==b});-1!=d&&c.splice(d,1)}}]),a}();b.exports=j},{"./glob":6,"./log":9}],9:[function(a,b){"use strict";var c,d=a("./glob.js"),e=function(a,b){console.log("["+new Date+" - "+a+"] "+b),c&&c(a,b)};e.listen=function(a){c=a},b.exports="dev"==d.__SIDESCROLLGAME.env?e:function(){}},{"./glob.js":6}],10:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=a("./log"),f=a("./physics"),g=function(){function a(b){c(this,a),this.canvas=b,this.bindBasicEvents(),this.vector,this.bound={mousedown:[],mouseup:[]}}return d(a,[{key:"bindBasicEvents",value:function(){var a=this;this.canvas.addEventListener("mousedown",function(b){var c=1==b.which?"left":3==b.which?"right":"other";a.vector=new f.Vector2D(b.x,b.y),e("Mouse","Mouse down at "+b.x+" x "+b.y+", using "+c+" button"),a.bound.mousedown.forEach(function(a){return a()})}),this.canvas.addEventListener("mouseup",function(b){a.vector.to(b.x,b.y),e("Mouse","Mouse released at "+b.x+" x "+b.y+", distance of "+a.vector.length()+" px"),a.bound.mouseup.forEach(function(a){return a()})})}},{key:"bind",value:function(a,b,c){this.bound[a].push(b.bind(c))}},{key:"directBind",value:function(a,b,c){this.canvas.addEventListener(a,b.bind(c))}}]),a}();b.exports=g},{"./log":9,"./physics":11}],11:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=Math.abs,e=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,d,e,f){c(this,a),this.x=b,this.y=d,this.destx=e,this.desty=f,this.velx=0,this.vely=0,this.accelx=0,this.accely=0,this.maxvelx,this.maxvely}return e(a,[{key:"add",value:function(b){return new a(this.x+b.x,this.y+b.y)}},{key:"sub",value:function(b){return new a(this.x-b.x,this.y-b.y)}},{key:"at",value:function(a,b){this.x=a,this.y=b}},{key:"to",value:function(a,b){this.destx=a,this.desty=b}},{key:"setMaxVelocity",value:function(a,b){this.maxvelx=a,this.maxvely=b}},{key:"setVelocity",value:function(a,b){this.velx=a,this.vely=b}},{key:"setAcceleration",value:function(a,b,c,d){this.accelx=a,this.accely=b,this.breakatzerox=c,this.breakatzeroy=d}},{key:"update",value:function(){var a=this.velx,b=this.vely;this.velx+=this.accelx,this.vely+=this.accely,this.maxvelx&&d(this.velx)>this.maxvelx&&(this.velx=this.maxvelx*(0>this.velx?-1:1)),this.maxvely&&d(this.vely)>this.maxvely&&(this.vely=this.maxvely*(0>this.vely?-1:1)),this.breakatzerox&&(0<a&&0>=this.velx||0>a&&0<=this.velx)&&(this.accelx=0,this.velx=0),this.breakatzeroy&&(0<b&&0>this.vely||0>b&&0<this.vely)&&(this.accely=0,this.vely=0),this.x+=this.velx,this.y+=this.vely}},{key:"length",value:function(){var a=Math.pow;return Math.sqrt(a(this.x-this.destx,2)+a(this.y-this.desty,2))}}]),a}(),g=function(){function d(a,b,e,f){c(this,d),this.x=a,this.y=b,this.w=e,this.h=f}return e(d,[{key:"points",get:function(){return[[this.x,this.y+this.h],[this.x,this.y],[this.x+this.w,this.y],[this.x+this.w,this.y+this.h]]}}],[{key:"fromVectors2D",value:function(c,a){return new d(c.x,c.y,a.x,a.y)}},{key:"Points",value:function(a,b,c,e){return new d(a,b,c,e).points}}]),d}(),h=function(){function a(){c(this,a)}return e(a,null,[{key:"rectangles",value:function(c,a){return!(c.y+c.h<a.y||c.y>a.y+a.h||c.x+c.w<a.x||c.x>a.x+a.w)}},{key:"vectors",value:function(){}},{key:"vect2rect",value:function(){}}]),a}();b.exports={Vector2D:f,Rect:g,Collider:h}},{}],12:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=a("./log"),f=a("./physics"),g=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};c(this,a),this.options=b,this.state=b.state||"neutral",this.initialstate=this.state,this.spritesets=b.spritesets||{},this.facing=b.facing||"right"}return d(a,[{key:"addState",value:function(a,b){this.spritesets[a]=b}},{key:"changeState",value:function(a,b){var c=this.state;this.state=a||this.initialstate,this.facing=b||this.facing,this.currentState||(this.spritesets[this.state]=this.spritesets.neutral),c!=this.state&&this.currentState.resetFrame()}},{key:"updateState",value:function(){this.currentState.nextFrame()}},{key:"draw",value:function(a,b,c,d,e){a.save();var f;return"right"==this.facing?this.useimagesize?f=this.currentState.draw(a,b,c):f=this.currentState.draw(a,b,c,d,e):"left"==this.facing&&(a.scale(-1,1),f=this.useimagesize?this.currentState.draw(a,-b-d,c):this.currentState.draw(a,-b-d,c,d,e),f.x=b),a.restore(),f}},{key:"currentState",get:function(){return this.spritesets[this.state]}}]),a}();b.exports=g},{"./log":9,"./physics":11}],13:[function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=a("./log"),f=a("./physics"),g=function(){function a(b,d,f,g,h){if(c(this,a),this.type=b,this.url=d,this.frame=0,this.framestateupdate=g||!1,this.drew=0,this.ready=!1,this.totalstates=f||1,this.noloop=h,this.states=[],e("SpriteSet","Creating new Sprite Set from "+this.url+" with "+this.totalstates+" states"),"singleimage"===b);else if("file"===b)this.load();else if("fileset"===b)this.load();else throw new Error("Created a SpriteSet with an invalid type : "+b)}return d(a,[{key:"getImageFromURL",value:function(a,b){var c=new Image;c.onload=function(){createImageBitmap(c).then(function(a){b(a)})},c.src=a}},{key:"resetFrame",value:function(){this.frame=0}},{key:"previousFrame",value:function(){this.frame--,0>this.frame&&(this.frame=this.totalstates-1)}},{key:"nextFrame",value:function(){this.frame++,this.frame==this.totalstates&&(this.frame=this.noloop?this.frame-1:0)}},{key:"load",value:function(a){var b=this;if("singleimage"==this.type);else{e("SpriteSet","Loading states from url scheme "+this.url);var c=-1,d=function d(){return++c==b.totalstates?(b.ready=!0,e("SpriteSet","Done loading states for SpriteSet with url "+b.url),a&&a()):void b.getImageFromURL(b.url.replace("$",c+1),function(a){b.states.push(a),d()})};d()}}},{key:"draw",value:function(a,b,c,d,e){if(this.ready)return b=b||0,c=c||0,d=d||this.currentFrame.width,e=e||this.currentFrame.height,a.drawImage(this.currentFrame,b,c,d,e),this.drew++,this.framestateupdate&&this.drew==this.framestateupdate&&(this.drew=0,this.nextFrame()),new f.Rect(b,c,d,e)}},{key:"destroy",value:function(){}},{key:"currentFrame",get:function(){return this.states[this.frame]}}]),a}();b.exports=g},{"./log":9,"./physics":11}]},{},[1]);
